class t{value;constructor(t){this.value=t}get text(){return this.value.toString()}getPos(t){return this.value/t}}const e="http://www.w3.org/2000/svg";function s(t,s,i=[]){const a=document.createElementNS(e,t);for(const t in s)void 0!==s[t]&&a.setAttribute(t,s[t]);for(const t of i??[])a.appendChild(t);return a}const i=(t={},...e)=>s("g",t,e),a=(t,...e)=>s("line",{...t,x1:t.from[0],y1:t.from[1],x2:t.to[0],y2:t.to[1],from:void 0,to:void 0},e),r=(t,...e)=>s("polyline",{...t,points:t.points.map((([t,e])=>`${t},${e}`)).join(" ")},e),o=(t,...e)=>s("text",t,e);class l{elem;data;xLabels;yLabels;style;maxX;maxY;resizeObserver;constructor(t){this.elem=((t,...i)=>s("svg",{...t,xmlns:e},i))({width:"100%",height:"100%",overflow:"visible"}),this.update(t,!1),this.resizeObserver=new ResizeObserver((t=>{this.draw(t[0].contentBoxSize[0].inlineSize,t[0].contentBoxSize[0].blockSize)})),this.resizeObserver.observe(this.elem,{box:"content-box"})}update({data:e,xLabels:s,yLabels:i,style:a},r=!0){this.data=Object.entries(e).sort(((t,e)=>e[1].max()-t[1].max())).map((([t,e])=>({name:t,values:e}))),this.maxX=this.data.map((({values:t})=>t.length-1)).max(),this.maxY=this.data[0].values.max(),this.xLabels=s??new Set(this.data.flatMap((({values:t})=>t.keys().toArray()))).values().toArray().sort().map((e=>new t(e))),this.yLabels=i??[new t(0),new t(this.maxY)],this.style={xAxisSize:a?.xAxisSize??30,yAxisSize:a?.yAxisSize??30},r&&this.draw(this.elem.clientWidth,this.elem.clientHeight)}draw(t,e){this.elem.innerHTML="",this.elem.appendChild(this.grid(this.style.yAxisSize,0,t-this.style.yAxisSize,e-this.style.xAxisSize)),this.elem.appendChild(this.axes(0,0,t,e)),this.elem.appendChild(this.lines(this.style.yAxisSize,0,t-this.style.yAxisSize,e-this.style.xAxisSize))}axes(t,e,s,a){return i({class:"axes",transform:`translate(${t}, ${e})`},this.xAxis(this.style.yAxisSize,a-this.style.xAxisSize,s-this.style.yAxisSize,this.style.xAxisSize),this.yAxis(0,0,this.style.yAxisSize,a-this.style.xAxisSize))}xAxis=(t,e,s,r)=>i({class:"xaxis"},a({from:[t,e],to:[t+s,e],stroke:"black"}),...this.xLabels.map((i=>o({x:t+i.getPos(this.maxX)*s,y:e+20,"text-anchor":"middle"},new Text(i.text)))));yAxis=(t,e,s,r)=>i({class:"yaxis"},a({from:[t+s,e],to:[t+s,e+r],stroke:"black"}),...this.yLabels.map((i=>o({x:t+s-10,y:e+(1-i.getPos(this.maxY))*r+5,"text-anchor":"end"},new Text(i.text)))));grid=(t,e,s,r)=>i({class:"grid",transform:`translate(${t}, ${e})`},...this.xLabels.map((t=>a({from:[t.getPos(this.maxX)*s,0],to:[t.getPos(this.maxX)*s,r],stroke:"#0004"}))),...this.yLabels.map((t=>a({from:[0,(1-t.getPos(this.maxY))*r],to:[s,(1-t.getPos(this.maxY))*r],stroke:"#0004"}))));lines(t,e,s,a){const o=i({class:"lines",transform:`translate(${t}, ${e})`,"stroke-width":"2"});for(const{name:t,values:e}of this.data){const t=e.map(((t,e)=>[e*s/this.maxX,(1-t/this.maxY)*a]));o.appendChild(r({points:t,fill:"none",stroke:"black"}))}return o}}Array.prototype.max=function(){return this.reduce(((t,e)=>Math.max(t,e)),0)},Array.prototype.min=function(){return this.reduce(((t,e)=>Math.min(t,e)),0)};export{t as NumberLabel,l as default};
//# sourceMappingURL=svgraph.js.map
